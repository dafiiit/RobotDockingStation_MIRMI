graph LR

  %% === ROBOTER ===
  subgraph Robot
    PiR(Raspberry Pi):::tumBlue
    WiFiR(WiFi + 5G Router)
    TailscaleR(Tailscale VPN Client)
    Switch(Ethernet Switch)

    %% Sensor-ESPs
    ESP_Cam[ESP - RGB Camera]
    ESP_IR[ESP - IR Camera]
    ESP_LIDAR[ESP - LIDAR]
    ESP_GPSR[ESP - GPS Receiver]
    ESP_FlowPump[ESP - Flowrate Sensor + 2x Pumps]

    %% Sensoren & Aktoren
    Cam(Camera)
    IR(IR Camera)
    LIDAR(LIDAR)
    GPSR(GPS Receiver)
    Flow(Flowrate Sensor)
    Pump1(Pump 1)
    Pump2(Pump 2)

    %% Verbindungen intern
    PiR --> WiFiR --> TailscaleR
    PiR -->|ROS2| Switch
    Switch --> ESP_Cam
    Switch --> ESP_IR
    Switch --> ESP_LIDAR
    Switch --> ESP_GPSR
    Switch --> ESP_FlowPump

    ESP_Cam --> Cam
    ESP_IR --> IR
    ESP_LIDAR --> LIDAR
    ESP_GPSR --> GPSR
    ESP_FlowPump --> Flow
    ESP_FlowPump --> Pump1 & Pump2
  end

  %% === DOCKINGSTATION ===
  subgraph Docking_Station
    PiD(Raspberry Pi):::tumBlue
    WiFiD(WiFi Router / Hotspot)
    TailscaleD(Tailscale VPN Client)

    %% ESP-Controller nach Gruppen
    ESP_Actuator[ESP - 4x Linear Actuators]
    ESP_Fluid[ESP - 2x Pumps + 3x Fluid Valves]
    ESP_Signal[ESP - IR-LED + GPS]

    %% Aktoren
    LA1(Linear Actuator 1)
    LA2(Linear Actuator 2)
    LA3(Linear Actuator 3)
    LA4(Linear Actuator 4)

    DPump1(Pump A)
    DPump2(Pump B)
    Valve1(Valve 1)
    Valve2(Valve 2)
    Valve3(Valve 3)

    IRLED(IR-LED)
    GPS_Tx(GPS Emitter)

    %% Verbindungen Dock
    PiD --> WiFiD --> ESP_Signal
    WiFiD --> ESP_Actuator
    WiFiD --> ESP_Fluid
    WiFiD --> TailscaleD 

    ESP_Actuator --> LA1 & LA2 & LA3 & LA4
    ESP_Fluid --> DPump1 & DPump2 & Valve1 & Valve2 & Valve3
    ESP_Signal --> IRLED & GPS_Tx
  end

  %% === ROS2 Netzwerkkommunikation ===
  TailscaleR -->|ROS2 Topics / Services| TailscaleD
  %%PiR -->|ROS2 Nodes| PiD
  
    %% === Styles ===
    %% TUM Farben und modernes Design f√ºr alle Diagramme
    %% --- BASIS-STYLES ---
    classDef tumBlue fill:#0065BD,stroke:#003359,stroke-width:2px,color:#ffffff,rx:12,ry:12,font-size:14px,font-weight:bold;

    classDef tumLightBlue fill:#64A0C8,stroke:#003359,stroke-width:2px,color:#ffffff,rx:12,ry:12,font-size:14px,font-weight:bold;

    classDef tumOrange fill:#E87722,stroke:#B85A1A,stroke-width:2px,color:#ffffff,rx:12,ry:12,font-size:14px,font-weight:bold;

    classDef tumGreen fill:#A2AD00,stroke:#7A8500,stroke-width:2px,color:#ffffff,rx:12,ry:12,font-size:14px,font-weight:bold;

    %% --- SUBGRAPH-STYLES ---
    style Robot fill:#F8FBFF,stroke:#0065BD,stroke-width:3px,rx:20,ry:20,color:#000000,font-size:16px,font-weight:bold;

    style Docking_Station fill:#F2FAF9,stroke:#64A0C8,stroke-width:3px,rx:20,ry:20,color:#000000,font-size:16px,font-weight:bold;

    %% Alle Verbindungen einheitlich stylen
    linkStyle default stroke:#0065BD,stroke-width:2px;